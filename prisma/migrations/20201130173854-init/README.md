# Migration `20201130173854-init`

This migration has been generated by PRANTA Dutta at 11/30/2020, 11:38:54 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "borrowers" (
"id" SERIAL,
    "userId" INTEGER NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "lenders" (
"id" SERIAL,
    "userId" INTEGER NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "loans" (
"id" SERIAL,
    "lenderIds" JSONB NOT NULL,
    "lenderId" INTEGER NOT NULL,
    "borrowerId" INTEGER NOT NULL,
    "userId" INTEGER NOT NULL,
    "loanMode" TEXT NOT NULL,
    "loanDuration" TEXT NOT NULL,
    "amount" INTEGER NOT NULL,
    "interestRate" INTEGER NOT NULL,
    "amountWithInterest" INTEGER NOT NULL,
    "companyFees" INTEGER NOT NULL,
    "amountWithInterestAndCompanyFees" INTEGER NOT NULL,
    "monthlyInstallment" INTEGER NOT NULL,
    "loanStartDate" TIMESTAMP(3) NOT NULL,
    "loanEndDate" TIMESTAMP(3) NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "penalties" (
"id" SERIAL,
    "userId" INTEGER NOT NULL,
    "loanId" INTEGER NOT NULL,
    "month" TEXT NOT NULL,
    "year" TEXT NOT NULL,
    "penaltyAmount" INTEGER NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "users" (
"id" SERIAL,
    "name" TEXT NOT NULL,
    "email" TEXT NOT NULL,
    "emailVerifiedAt" TIMESTAMP(3),
    "dateOfBirth" TEXT NOT NULL,
    "password" TEXT NOT NULL,
    "role" TEXT NOT NULL,
    "gender" TEXT NOT NULL,
    "address" TEXT,
    "mobileNo" TEXT,
    "documentType" TEXT,
    "verified" TEXT NOT NULL DEFAULT E'false',
    "borrowerType" TEXT,
    "verificationNo" TEXT,
    "verificationPhotos" JSONB,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "wallets" (
"id" SERIAL,
    "userId" INTEGER NOT NULL,
    "loanId" INTEGER NOT NULL,
    "balance" INTEGER NOT NULL,
    "type" TEXT NOT NULL,
    "createdAt" TIMESTAMP(3) NOT NULL DEFAULT CURRENT_TIMESTAMP,
    "updatedAt" TIMESTAMP(3) NOT NULL,

    PRIMARY KEY ("id")
)

CREATE TABLE "password_resets" (
"id" SERIAL,
    "userId" INTEGER NOT NULL,
    "email" TEXT NOT NULL,
    "token" TEXT NOT NULL,
    "created_at" TIMESTAMP(3),

    PRIMARY KEY ("id")
)

CREATE TABLE "laravel_migrations" (
"id" SERIAL,
    "migration" TEXT NOT NULL,
    "batch" INTEGER NOT NULL,

    PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "users.email_unique" ON "users"("email")

CREATE INDEX "password_resets_email_index" ON "password_resets"("email")

ALTER TABLE "borrowers" ADD FOREIGN KEY("userId")REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "lenders" ADD FOREIGN KEY("userId")REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "loans" ADD FOREIGN KEY("borrowerId")REFERENCES "borrowers"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "loans" ADD FOREIGN KEY("lenderId")REFERENCES "lenders"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "loans" ADD FOREIGN KEY("userId")REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "penalties" ADD FOREIGN KEY("loanId")REFERENCES "loans"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "penalties" ADD FOREIGN KEY("userId")REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "wallets" ADD FOREIGN KEY("loanId")REFERENCES "loans"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "wallets" ADD FOREIGN KEY("userId")REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "password_resets" ADD FOREIGN KEY("userId")REFERENCES "users"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20201130173854-init
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,128 @@
+generator client {
+  provider = "prisma-client-js"
+}
+
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+model borrowers {
+  id        Int      @id @default(autoincrement())
+  userId    Int
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  users     users    @relation(fields: [userId], references: [id])
+  loans     loans[]
+}
+
+model lenders {
+  id        Int      @id @default(autoincrement())
+  userId    Int
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  users     users    @relation(fields: [userId], references: [id])
+  loans     loans[]
+}
+
+model loans {
+  id                               Int         @id @default(autoincrement())
+  lenderIds                        Json
+  lenderId                         Int
+  borrowerId                       Int
+  userId                           Int
+  loanMode                         String
+  loanDuration                     String
+  amount                           Int
+  interestRate                     Int
+  amountWithInterest               Int
+  companyFees                      Int
+  amountWithInterestAndCompanyFees Int
+  monthlyInstallment               Int
+  loanStartDate                    DateTime
+  loanEndDate                      DateTime
+  createdAt                        DateTime    @default(now())
+  updatedAt                        DateTime    @updatedAt
+  borrowers                        borrowers   @relation(fields: [borrowerId], references: [id])
+  lenders                          lenders     @relation(fields: [lenderId], references: [id])
+  users                            users       @relation(fields: [userId], references: [id])
+  penalties                        penalties[]
+  wallets                          wallets[]
+}
+
+model penalties {
+  id            Int      @id @default(autoincrement())
+  userId        Int
+  loanId        Int
+  month         String
+  year          String
+  penaltyAmount Int
+  createdAt     DateTime @default(now())
+  updatedAt     DateTime @updatedAt
+  loans         loans    @relation(fields: [loanId], references: [id])
+  users         users    @relation(fields: [userId], references: [id])
+}
+
+model users {
+  id                 Int               @id @default(autoincrement())
+  name               String
+  email              String            @unique
+  emailVerifiedAt    DateTime?
+  dateOfBirth        String
+  password           String
+  role               String
+  gender             String
+  address            String?
+  mobileNo           String?
+  documentType       String?
+  verified           String            @default("false")
+  borrowerType       String?
+  verificationNo     String?
+  verificationPhotos Json?
+  createdAt          DateTime          @default(now())
+  updatedAt          DateTime          @updatedAt
+  borrowers          borrowers[]
+  lenders            lenders[]
+  loans              loans[]
+  password_resets    password_resets[]
+  penalties          penalties[]
+  wallets            wallets[]
+}
+
+model wallets {
+  id        Int      @id @default(autoincrement())
+  userId    Int
+  loanId    Int
+  balance   Int
+  type      String
+  createdAt DateTime @default(now())
+  updatedAt DateTime @updatedAt
+  loans     loans    @relation(fields: [loanId], references: [id])
+  users     users    @relation(fields: [userId], references: [id])
+}
+
+model password_resets {
+  id         Int       @id @default(autoincrement())
+  userId     Int
+  email      String
+  token      String
+  created_at DateTime?
+  users      users     @relation(fields: [userId], references: [id])
+
+  @@index([email], name: "password_resets_email_index")
+}
+
+model laravel_migrations {
+  id        Int    @id @default(autoincrement())
+  migration String
+  batch     Int
+}
+
+enum Role {
+  admin
+  borrower
+  lender
+}
+
+// createdAt DateTime @default(now())
+// updatedAt DateTime @updatedAt
```


